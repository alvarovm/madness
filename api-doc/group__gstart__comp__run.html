<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MADNESS: Compiling and running MADNESS programs</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MADNESS
   &#160;<span id="projectnumber">0.10.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Compiling and running MADNESS programs<div class="ingroups"><a class="el" href="group__getting__started.html">Getting started with MADNESS</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000006">Todo:</a></b></dt><dd>Verify that the code snippets here aren't stale. They're imported from a 2010 document.</dd></dl>
<dl class="section user"><dt>Compiling your program</dt><dd></dd></dl>
<p>Assuming your code is in saved in <code>fred.cc</code>, to make the program type </p><div class="fragment"><div class="line">make -<a class="code" href="derivatives_8cc.html#a077a479820cb59b18ba5f9565d735e0f">f</a> trunk/doc/devsamp/Makefile.sample <a class="code" href="tdse4_8cc.html#ac63c8aae13d788421ccbc301126510c2">fred</a></div>
</div><!-- fragment --><p> The example makefile <code>Makefile.sample</code> must be copied and modified for projects with more than one source file (see the end of that file for an example).</p>
<dl class="section user"><dt>Running your program</dt><dd></dd></dl>
<p><em>On a single workstation or laptop</em></p>
<p>Just type the name of the executable in the directory where the binary is located, </p><div class="fragment"><div class="line">./<a class="code" href="tdse4_8cc.html#ac63c8aae13d788421ccbc301126510c2">fred</a></div>
</div><!-- fragment --><p>Hopefully it will print </p><pre class="fragment">The result is 1.839072e+00
</pre><p><em>You are already running in parallel.</em></p>
<p>Behind the scenes, MADNESS inquired how many processors or cores were installed in your computer and launched that many threads to perform the work. If you wish to use fewer processors, set the environment variable <code>MAD_NUM_THREADS</code> to be the total number of processors or cores you wish to use (note that if using MPI, an additional server thread is also employed for massage passing). For example, to use just 3 processors, in the bash shell type </p><div class="fragment"><div class="line">export MAD_NUM_THREADS=3</div>
</div><!-- fragment --><p> and in the <a class="el" href="classC.html">C</a> shell type </p><div class="fragment"><div class="line">setenv MAD_NUM_THREADS 3</div>
</div><!-- fragment --><dl class="section attention"><dt>Attention</dt><dd>Using more threads than processors can result in catastrophic slowdown since MADNESS uses spinlocks. If you need to oversubscribe the physical processors (or run inside a virtual machine), configure with the option <code>--enable-never-spin</code>.</dd></dl>
<p><em> On a parallel computer using MPI (distributed or shared memory)</em></p>
<p>This is going to vary from system to system. Generically, to run on <code>N</code> nodes with <code>T</code> applications threads per node (an extra server thread for message passing is also created if <code>N</code> <img class="formulaInl" alt="$&gt;1$" src="form_9.png"/>), you will type (in the bash shell) something like </p><div class="fragment"><div class="line">MAD_NUM_THREADS=<a class="code" href="iterate__gamma_8cc.html#adc939c0f0132b4f1fc28d054834a4ea4">T</a> mpirun -<a class="code" href="tdse1d_8cc.html#a928495140935d9d6ce0a100550473140">np</a> <a class="code" href="testconv_8cc.html#a0240ac851181b84ac374872dc5434ee4">N</a> ./<a class="code" href="tdse4_8cc.html#ac63c8aae13d788421ccbc301126510c2">fred</a></div>
</div><!-- fragment --><p>We want <code>mpirun</code> to start one process per node, and MADNESS will look after starting one thread per processor/core. But this is easier said than done and sadly changes with each revision of the vendors system software. Please refer to the MADNESS wiki for current examples for how to run on the Cray-XT5 and IBM BG/P.</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000007">Todo:</a></b></dt><dd>We might want to update this last paragraph.</dd></dl>
<p>Previous: <a class="el" href="group__gstart__basics.html">MADNESS basics</a>; Next: <a class="el" href="group__gstart__functions.html">MADNESS functions</a> </p>
</div><!-- contents -->
<div class="ttc" id="atdse1d_8cc_html_a928495140935d9d6ce0a100550473140"><div class="ttname"><a href="tdse1d_8cc.html#a928495140935d9d6ce0a100550473140">np</a></div><div class="ttdeci">int np</div><div class="ttdef"><b>Definition:</b> tdse1d.cc:166</div></div>
<div class="ttc" id="aderivatives_8cc_html_a077a479820cb59b18ba5f9565d735e0f"><div class="ttname"><a href="derivatives_8cc.html#a077a479820cb59b18ba5f9565d735e0f">f</a></div><div class="ttdeci">double(* f)(const coord_3d &amp;)</div><div class="ttdef"><b>Definition:</b> derivatives.cc:53</div></div>
<div class="ttc" id="atestconv_8cc_html_a0240ac851181b84ac374872dc5434ee4"><div class="ttname"><a href="testconv_8cc.html#a0240ac851181b84ac374872dc5434ee4">N</a></div><div class="ttdeci">#define N</div><div class="ttdef"><b>Definition:</b> testconv.cc:38</div></div>
<div class="ttc" id="aiterate__gamma_8cc_html_adc939c0f0132b4f1fc28d054834a4ea4"><div class="ttname"><a href="iterate__gamma_8cc.html#adc939c0f0132b4f1fc28d054834a4ea4">T</a></div><div class="ttdeci">response_space T(World &amp;world, response_space &amp;f)</div><div class="ttdef"><b>Definition:</b> iterate_gamma.cc:510</div></div>
<div class="ttc" id="atdse4_8cc_html_ac63c8aae13d788421ccbc301126510c2"><div class="ttname"><a href="tdse4_8cc.html#ac63c8aae13d788421ccbc301126510c2">fred</a></div><div class="ttdeci">double fred(const coordT &amp;r)</div><div class="ttdef"><b>Definition:</b> tdse4.cc:369</div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Aug 30 2022 05:23:55 for MADNESS by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
